<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	template="/WEB-INF/template/template_user.xhtml">

	<f:metadata>


	</f:metadata>


	<h:head>



	</h:head>

	<ui:define name="labelcenter">Meus pedidos</ui:define>


	<ui:define name="title">Meus pedidos</ui:define>>
	

	<ui:define name="container">

		<h:body>

			<h:form id="form">
				<p:growl id="msgs" showDetail="true" autoUpdate="true" />
				<div align="center">

					<p:panelGrid columns="1" layout="grid" style="width:100%;">

						<p:tabView orientation="left">
							<p:tab title="Seus Pedidos">
								<p:dataTable id="tabOrder" var="order"
									emptyMessage="Nao existe dados correspondentes."
									value="#{customerBean.listOrderCustomer()}" editable="true"
									style="margin-bottom:40px;text-align: center;" widgetVar="od"
									reflow="true">


									<f:facet name="header">
										Seus Pedidos
									</f:facet>

									<p:rowExpansion>
										<p:dataTable id="subTab" value="#{order.itemProducts}"
											editable="true" var="itemProduct">

											<p:column headerText="Nome" width="140">
												<h:outputText value="#{itemProduct.itemMenu.product.name}" />
											</p:column>

											<p:column headerText="Quant." width="160">
												<h:outputText value="#{itemProduct.amount}" />
											</p:column>

											<p:column headerText="Preço" width="160">
												<h:outputText value="R$ #{itemProduct.price}" />
											</p:column>



										</p:dataTable>
									</p:rowExpansion>

									<p:column style="width:4%">
										<p:rowToggler />
									</p:column>

									<p:column filterStyle="display:none;" filterBy="#{order.data}"
										headerText="Data" width="20%">

										<p:outputLabel value="#{order.data}">
											<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
										</p:outputLabel>

									</p:column>

									<p:column filterStyle="display:none;"
										filterBy="#{order.totalprice}" headerText="Preco Total"
										width="14%">

										<p:outputLabel value="R$ #{order.totalprice}" />

									</p:column>

									<p:column filterStyle="display:none;"
										filterBy="#{order.delivery.state}" headerText="Situação"
										width="60">

										<p:outputLabel
											value="#{order.delivery.state == true ? 'Finalizada' : 'Em Andamento'}" />

									</p:column>

									<p:column filterStyle="display:none;"
										filterBy="#{order.delivery.state}" width="13%">

										<p:button
											disabled="#{order.ratingOrder != null || order.ratingOrder == null and !(order.delivery.state)}"
											icon="fa fa-star" value="avaliar"
											outcome="/pages/user/rating_itens" style="width:80%">

											<f:param name="orderrating" value="#{order.id}"></f:param>
										</p:button>

									</p:column>


								</p:dataTable>
							</p:tab>
							<p:tab title="Alterar Conta">


								<div align="left">
									<p:tab title="Alterar Conta">
										<div class="ui-fluid">
											<p:panelGrid columns="2" layout="grid">

												<p:outputLabel for="email" value="e-mail"></p:outputLabel>
												<p:inputText id="email"
													value="#{authenticateBen.customer.user.email}"
													required="true"></p:inputText>


												<p:outputLabel for="user" value="username"></p:outputLabel>
												<p:inputText required="true" id="user"
													value="#{authenticateBen.customer.user.login}"></p:inputText>

												<p:outputLabel for="password" value="Senha"></p:outputLabel>
												<p:password required="true" id="password"
													value="#{authenticateBen.customer.user.password}"></p:password>


											</p:panelGrid>

										</div>
										<p:toolbar style="background:white">

											<f:facet name="left">

												<div align="left">
													<p:commandButton value="Atualizar"
														action="#{customerBean.save()}" style="width:100px">

														<f:setPropertyActionListener
															value="#{authenticateBen.customer}"
															target="#{customerBean.customer}"></f:setPropertyActionListener>

													</p:commandButton>

												</div>
											</f:facet>

										</p:toolbar>

									</p:tab>
								</div>

							</p:tab>
							<p:tab title="Excluir Conta">
								<h:panelGrid columns="2" cellpadding="10">
									<h:outputText value="EM CONSTRUÇÂO" />
								</h:panelGrid>
							</p:tab>
						</p:tabView>


					</p:panelGrid>
				</div>


				<!-- <p:dialog id="dialog" header="Avaliação Pedido" widgetVar="dlg"
					width="24%" height="27%" resizable="false" closable="true"
					appendToBody="false" responsive="true"
					style="background:white !important;" modal="true">

					<div class="ui-fluid">
						<p:panelGrid columns="1" layout="grid"
							styleClass="ui-panelgrid-blank">

							<p:outputLabel for="rating" value="avalie" />
							<p:rating id="rating" stars="5"
								value="#{ratingOrderBean.rating.number}" />

							<p:outputLabel for="txtcomment" value="Comentário:"></p:outputLabel>
							<p:inputTextarea id="txtcomment"
								value="#{ratingOrderBean.rating.comments}"></p:inputTextarea>
						</p:panelGrid>
						<p:spacer></p:spacer>
						<p:commandButton value="enviar" oncomplete="PF('dlg').hide();"
							action="#{ratingOrderBean.registerRating()}" update=":form"></p:commandButton>
					</div>
				</p:dialog>
 -->

			</h:form>
		</h:body>
	</ui:define>
</ui:composition>